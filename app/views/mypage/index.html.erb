<!DOCTYPE html>
<html>
  <head>
    <title>CalorieFriends</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.css">
    <%= stylesheet_link_tag "application", "data-turbo-track": "reload" %>
    <%= javascript_importmap_tags %>
  </head>

  <body>
   <h1>BMR Calculator</h1>
  
  <form id="bmrForm">
    <label for="weight">Weight (kg):</label>
    <input type="number" id="weight" required>
    
    <br>
    
    <label for="height">Height (cm):</label>
    <input type="number" id="height" required>
    
    <br>
    
    <label for="age">Age:</label>
    <input type="number" id="age" required>
    
    <br>
    
    <label for="gender">Gender:</label>
    <select id="gender" required>
      <option value="male">Male</option>
      <option value="female">Female</option>
    </select>
    
    <br>
    
    <button type="button" onclick="calculateBMR()">Calculate BMR</button>
  </form>

  <div id="result"></div>

  <script>
    function calculateBMR() {
      var weight = document.getElementById('weight').value;
      var height = document.getElementById('height').value;
      var age = document.getElementById('age').value;
      var gender = document.getElementById('gender').value;

      fetch('/calculations/calculate_bmr', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'X-CSRF-Token': document.querySelector('meta[name="csrf-token"]').content
        },
        body: JSON.stringify({ weight: weight, height: height, age: age, gender: gender })
      })
      .then(response => response.json())
      .then(data => {
        document.getElementById('result').innerHTML = 'BMR: ' + data.bmr.toFixed(2) + ' kcal/day';
      });
    }
  
  </body>
</html>